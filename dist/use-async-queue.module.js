import{useState as n,useRef as t,useCallback as r,useEffect as u}from"react";import e from"next-tick";export default function(i){var c=i.concurrency;void 0===c&&(c=8);var s=i.done,o=i.drain,g=i.inflight;c<1&&(c=Infinity);var a=n({numPending:0,numInFlight:0,numDone:0}),m=a[0],f=a[1],h=t(!0),l=t([]),d=t([]);return u(function(){if(m.numDone>0&&o&&0===l.current.length&&0===d.current.length&&!h.current)return h.current=!0,e(o);for(var n=function(){h.current=!1;var n=d.current.shift();l.current.push(n),f(function(n){return Object.assign({},n,{numPending:n.numPending-1,numInFlight:n.numInFlight+1})}),g&&g(Object.assign({},n,{stats:m}));var t=n.task();t.then(function(){l.current.pop(),f(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),s&&s(Object.assign({},n,{result:t,stats:m}))}).catch(function(){l.current.pop(),f(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),s&&s(Object.assign({},n,{result:t,stats:m}))})};l.current.length<c&&d.current.length>0;)n()},[c,s,o,g,m]),{add:r(function(n){d.current.push(n),f(function(n){return Object.assign({},n,{numPending:n.numPending+1})})},[]),stats:m}}
//# sourceMappingURL=use-async-queue.module.js.map
