import{useState as n,useRef as t,useCallback as r,useEffect as u}from"react";export default function(e){var i=e.concurrency;void 0===i&&(i=8);var c=e.done,s=e.drain,o=e.inflight;i<1&&(i=Infinity);var g=n({numPending:0,numInFlight:0,numDone:0}),a=g[0],m=g[1],f=t(!0),h=t([]),l=t([]);return u(function(){if(a.numDone>0&&s&&0===h.current.length&&0===l.current.length&&!f.current)return f.current=!0,s();for(var n=function(){f.current=!1;var n=l.current.shift();h.current.push(n),m(function(n){return Object.assign({},n,{numPending:n.numPending-1,numInFlight:n.numInFlight+1})}),o&&o(Object.assign({},n,{stats:a}));var t=n.task();t.then(function(){h.current.pop(),m(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),c&&c(Object.assign({},n,{result:t,stats:a}))}).catch(function(){h.current.pop(),m(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),c&&c(Object.assign({},n,{result:t,stats:a}))})};h.current.length<i&&l.current.length>0;)n()},[i,c,s,o,a]),{add:r(function(n){l.current.push(n),m(function(n){return Object.assign({},n,{numPending:n.numPending+1})})},[]),stats:a}}
//# sourceMappingURL=use-async-queue.module.js.map
