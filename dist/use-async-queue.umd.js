!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react"),require("next-tick")):"function"==typeof define&&define.amd?define(["react","next-tick"],e):n.useAsyncQueue=e(n.react,n.nextTick)}(this,function(n,e){return e=e&&e.hasOwnProperty("default")?e.default:e,function(t){var u=t.concurrency;void 0===u&&(u=8);var r=t.done,i=t.drain,c=t.inflight;u<1&&(u=Infinity);var s=n.useState({numPending:0,numInFlight:0,numDone:0}),o=s[0],f=s[1],a=n.useRef(!0),g=n.useRef([]),m=n.useRef([]);return n.useEffect(function(){if(o.numDone>0&&i&&0===g.current.length&&0===m.current.length&&!a.current)return a.current=!0,e(i);for(var n=function(){a.current=!1;var n=m.current.shift();g.current.push(n),f(function(n){return Object.assign({},n,{numPending:n.numPending-1,numInFlight:n.numInFlight+1})}),c&&c(Object.assign({},n,{stats:o}));var e=n.task();e.then(function(){g.current.pop(),f(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),r&&r(Object.assign({},n,{result:e,stats:o}))}).catch(function(){g.current.pop(),f(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),r&&r(Object.assign({},n,{result:e,stats:o}))})};g.current.length<u&&m.current.length>0;)n()},[u,r,i,c,o]),{add:n.useCallback(function(n){m.current.push(n),f(function(n){return Object.assign({},n,{numPending:n.numPending+1})})},[]),stats:o}}});
//# sourceMappingURL=use-async-queue.umd.js.map
