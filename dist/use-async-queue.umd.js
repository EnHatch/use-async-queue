!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("react")):"function"==typeof define&&define.amd?define(["react"],e):n.useAsyncQueue=e(n.react)}(this,function(n){return function(e){var t=e.concurrency;void 0===t&&(t=8);var u=e.done,r=e.drain,i=e.inflight;t<1&&(t=Infinity);var c=n.useState({numPending:0,numInFlight:0,numDone:0}),s=c[0],o=c[1],f=n.useRef(!0),a=n.useRef([]),g=n.useRef([]);return n.useEffect(function(){if(s.numDone>0&&r&&0===a.current.length&&0===g.current.length&&!f.current)return f.current=!0,r();for(var n=function(){f.current=!1;var n=g.current.shift();a.current.push(n),o(function(n){return Object.assign({},n,{numPending:n.numPending-1,numInFlight:n.numInFlight+1})}),i&&i(Object.assign({},n,{stats:s}));var e=n.task();e.then(function(){a.current.pop(),o(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),u&&u(Object.assign({},n,{result:e,stats:s}))}).catch(function(){a.current.pop(),o(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),u&&u(Object.assign({},n,{result:e,stats:s}))})};a.current.length<t&&g.current.length>0;)n()},[t,u,r,i,s]),{add:n.useCallback(function(n){g.current.push(n),o(function(n){return Object.assign({},n,{numPending:n.numPending+1})})},[]),stats:s}}});
//# sourceMappingURL=use-async-queue.umd.js.map
