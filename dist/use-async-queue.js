var n,t=require("react"),e=(n=require("next-tick"))&&"object"==typeof n&&"default"in n?n.default:n;module.exports=function(n){var u=n.concurrency;void 0===u&&(u=8);var r=n.done,i=n.drain,c=n.inflight;u<1&&(u=Infinity);var s=t.useState({numPending:0,numInFlight:0,numDone:0}),a=s[0],o=s[1],g=t.useRef(!0),f=t.useRef([]),l=t.useRef([]);return t.useEffect(function(){if(a.numDone>0&&i&&0===f.current.length&&0===l.current.length&&!g.current)return g.current=!0,e(i);for(var n=function(){g.current=!1;var n=l.current.shift();f.current.push(n),o(function(n){return Object.assign({},n,{numPending:n.numPending-1,numInFlight:n.numInFlight+1})}),c&&c(Object.assign({},n,{stats:a}));var t=n.task();t.then(function(){f.current.pop(),o(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),r&&r(Object.assign({},n,{result:t,stats:a}))}).catch(function(){f.current.pop(),o(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),r&&r(Object.assign({},n,{result:t,stats:a}))})};f.current.length<u&&l.current.length>0;)n()},[u,r,i,c,a]),{add:t.useCallback(function(n){l.current.push(n),o(function(n){return Object.assign({},n,{numPending:n.numPending+1})})},[]),stats:a}};
//# sourceMappingURL=use-async-queue.js.map
