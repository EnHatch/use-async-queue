var n,t=require("react"),e=(n=require("next-tick"))&&"object"==typeof n&&"default"in n?n.default:n;module.exports=function(n){var u=n.done,r=n.drain,i=n.inflight,c=n.concurrency;c<1&&(c=Infinity);var s=t.useState({numPending:0,numInFlight:0,numDone:0}),a=s[0],o=s[1],g=t.useRef(!0),f=t.useRef([]),l=t.useRef([]);return t.useEffect(function(){if(a.numDone>0&&r&&0===f.current.length&&0===l.current.length&&!g.current)return g.current=!0,e(r);for(var n=function(){g.current=!1;var n=l.current.shift();f.current.push(n),o(function(n){return Object.assign({},n,{numPending:n.numPending-1,numInFlight:n.numInFlight+1})}),i&&i(Object.assign({},n,{stats:a}));var t=n.task();t.then(function(){f.current.pop(),o(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),u&&u(Object.assign({},n,{result:t,stats:a}))}).catch(function(){f.current.pop(),o(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),u&&u(Object.assign({},n,{result:t,stats:a}))})};f.current.length<c&&l.current.length>0;)n()},[c,u,r,i,a]),{add:t.useCallback(function(n){l.current.push(n),o(function(n){return Object.assign({},n,{numPending:n.numPending+1})})},[]),stats:a}};
//# sourceMappingURL=use-async-queue.js.map
