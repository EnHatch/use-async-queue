var n=require("react");module.exports=function(t){var e=t.concurrency;void 0===e&&(e=8);var u=t.done,r=t.drain,i=t.inflight;e<1&&(e=Infinity);var c=n.useState({numPending:0,numInFlight:0,numDone:0}),s=c[0],a=c[1],g=n.useRef(!0),o=n.useRef([]),f=n.useRef([]);return n.useEffect(function(){if(s.numDone>0&&r&&0===o.current.length&&0===f.current.length&&!g.current)return g.current=!0,r();for(var n=function(){g.current=!1;var n=f.current.shift();o.current.push(n),a(function(n){return Object.assign({},n,{numPending:n.numPending-1,numInFlight:n.numInFlight+1})}),i&&i(Object.assign({},n,{stats:s}));var t=n.task();t.then(function(){o.current.pop(),a(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),u&&u(Object.assign({},n,{result:t,stats:s}))}).catch(function(){o.current.pop(),a(function(n){return Object.assign({},n,{numInFlight:n.numInFlight-1,numDone:n.numDone+1})}),u&&u(Object.assign({},n,{result:t,stats:s}))})};o.current.length<e&&f.current.length>0;)n()},[e,u,r,i,s]),{add:n.useCallback(function(n){f.current.push(n),a(function(n){return Object.assign({},n,{numPending:n.numPending+1})})},[]),stats:s}};
//# sourceMappingURL=use-async-queue.js.map
